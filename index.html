<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="msapplication-tap-highlight" content="no" />
    <title>Justin's KidPix</title>
    <link rel="stylesheet" type="text/css" href="css/kidpix.css" />
    <link rel="icon" type="image/png" href="img/branding/kidpix.png" />

    <!-- Initialize global KiddoPaint namespace before modules load -->
    <script>
      // Initialize the global KiddoPaint namespace
      window.KiddoPaint = {};
      window.KiddoPaint.Tools = {};
      window.KiddoPaint.Tools.Toolbox = {};
      window.KiddoPaint.Textures = {};
      window.KiddoPaint.Brushes = {};
      window.KiddoPaint.Builders = {};
      window.KiddoPaint.Stamps = {};
      window.KiddoPaint.Sounds = {};
      window.KiddoPaint.Display = {};
      window.KiddoPaint.Colors = {};
      window.KiddoPaint.Current = {};
      window.KiddoPaint.Cache = {};
      window.KiddoPaint.Text = {};
      window.KiddoPaint.Sprite = {};
    </script>

    <!-- Bundled KidPix JavaScript modules -->
    <script type="module" src="/src/kidpix-main.js"></script>
  </head>

  <body>
    <!-- React version -->
    <div id="react-root" style="display: none"></div>

    <!-- Original JavaScript version (default for now) -->
    <div id="js-root">
      <div id="container">
        <div id="toolbar">
          <div id="mainbar">
            <button class="tool" id="save" title="Save">
              <img src="img/toolbar/kp-m_27.png" class="pixelated" />
            </button>
            <button class="tool" id="pencil" title="Pencil">
              <img
                src="img/toolbar/kp-m_28.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="line" title="Line">
              <img
                src="img/toolbar/kp-m_29.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="square" title="Rectangle">
              <img
                src="img/toolbar/kp-m_30.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="circle" title="Circle">
              <img
                src="img/toolbar/kp-m_31.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="brush" title="Brush">
              <img
                src="img/toolbar/kp-m_32.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="jumble" title="Mixer">
              <img
                src="img/toolbar/kp-m_33.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="paintcan" title="Paint Can">
              <img
                src="img/toolbar/kp-m_34.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="eraser" title="Eraser">
              <img
                src="img/toolbar/kp-m_35.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="text" title="Text">
              <img
                src="img/toolbar/kp-m_36.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="stamp" title="Stamp">
              <img
                src="img/toolbar/kp-m_37.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="truck" title="Truck">
              <img
                src="img/toolbar/kp-m_38.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="colorpicker" title="Color Picker">
              <img
                src="img/color-picker/eyedropper-icon.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="undo" title="Undo">
              <img
                src="img/toolbar/kp-m_39.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="redo" title="Redo">
              <img
                src="img/toolbar/kp-m_40.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
          </div>
          <br />
          <div id="colorbar">
            <button class="currentColor" id="currentColor"></button>
            <div id="colorselector">
              <button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button>
            </div>
            <div>
              <button class="colornav" id="colorprev">←</button
              ><button class="colornav" id="colornext">→</button>
            </div>
            <div id="palette-name" style="text-align: center; font-size: 12px; color: #666; margin: 2px 0;">Basic</div>
            <br />
            <div>
              <button class="colornav">
                <a
                  href="https://github.com/justinpearson/kidpix"
                  target="_blank"
                  ><img
                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTIgMGMtNi42MjYgMC0xMiA1LjM3My0xMiAxMiAwIDUuMzAyIDMuNDM4IDkuOCA4LjIwNyAxMS4zODcuNTk5LjExMS43OTMtLjI2MS43OTMtLjU3N3YtMi4yMzRjLTMuMzM4LjcyNi00LjAzMy0xLjQxNi00LjAzMy0xLjQxNi0uNTQ2LTEuMzg3LTEuMzMzLTEuNzU2LTEuMzMzLTEuNzU2LTEuMDg5LS43NDUuMDgzLS43MjkuMDgzLS43MjkgMS4yMDUuMDg0IDEuODM5IDEuMjM3IDEuODM5IDEuMjM3IDEuMDcgMS44MzQgMi44MDcgMS4zMDQgMy40OTIuOTk3LjEwNy0uNzc1LjQxOC0xLjMwNS43NjItMS42MDQtMi42NjUtLjMwNS01LjQ2Ny0xLjMzNC01LjQ2Ny01LjkzMSAwLTEuMzExLjQ2OS0yLjM4MSAxLjIzNi0zLjIyMS0uMTI0LS4zMDMtLjUzNS0xLjUyNC4xMTctMy4xNzYgMCAwIDEuMDA4LS4zMjIgMy4zMDEgMS4yMy45NTctLjI2NiAxLjk4My0uMzk5IDMuMDAzLS40MDQgMS4wMi4wMDUgMi4wNDcuMTM4IDMuMDA2LjQwNCAyLjI5MS0xLjU1MiAzLjI5Ny0xLjIzIDMuMjk3LTEuMjMuNjUzIDEuNjUzLjI0MiAyLjg3NC4xMTggMy4xNzYuNzcuODQgMS4yMzUgMS45MTEgMS4yMzUgMy4yMjEgMCA0LjYwOS0yLjgwNyA1LjYyNC01LjQ3OSA1LjkyMS40My4zNzIuODIzIDEuMTAyLjgyMyAyLjIyMnYzLjI5M2MwIC4zMTkuMTkyLjY5NC44MDEuNTc2IDQuNzY1LTEuNTg5IDguMTk5LTYuMDg2IDguMTk5LTExLjM4NiAwLTYuNjI3LTUuMzczLTEyLTEyLTEyeiIvPjwvc3ZnPg=="
                    class="github"
                /></a></button
              ><button class="colornav">
                <a href="https://justinppearson.com/" target="_blank"
                  ><img
                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIvPjxsaW5lIHgxPSIyIiB5MT0iMTIiIHgyPSIyMiIgeTI9IjEyIi8+PGxpbmUgeDE9IjEyIiB5MT0iMiIgeDI9IjEyIiB5Mj0iMjIiLz48cGF0aCBkPSJNMTIgMmMtMyAwLTUuNSA0LjUtNS41IDEwczIuNSAxMCA1LjUgMTAiLz48cGF0aCBkPSJNMTIgMmMzIDAgNS41IDQuNSA1LjUgMTBzLTIuNSAxMC01LjUgMTAiLz48L3N2Zz4="
                    class="github"
                /></a></button
              ><button class="colornav">
                <a href="docs/" target="_blank"
                  ><img
                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIj48cGF0aCBkPSJNMTQgMmwtNiAwYy0xIDAtMiAxLTIgMnYxNmMwIDEgMSAyIDIgMmgxMmMxIDAgMi0xIDItMlY4bC02LTZ6Ii8+PHBvbHlsaW5lIHBvaW50cz0iMTQsMiAxNCw4IDIwLDgiLz48bGluZSB4MT0iMTYiIHkxPSIxMyIgeDI9IjgiIHkyPSIxMyIvPjxsaW5lIHgxPSIxNiIgeTE9IjE3IiB4Mj0iOCIgeTI9IjE3Ii8+PC9zdmc+"
                    class="github"
                /></a>
              </button>
            </div>
          </div>
        </div>
        <div id="hcontainer">
          <div id="subtoolbars" class="subtoolbar">
            <div id="genericsubmenu" class="hidden"></div>
            <div id="texttoolbar" class="hidden">
              <button class="tool text" id="xal0"></button>
              <button class="tool text" id="xal1"></button>
              <button class="tool text" id="xal2"></button>
              <button class="tool text" id="xal3"></button>
              <button class="tool text" id="xal4"></button>
              <button class="tool text" id="xal5"></button>
              <button class="tool text" id="xal6"></button>
              <button class="tool text" id="xal7"></button>
              <button class="tool text" id="xal8"></button>
              <button class="tool text" id="xal9"></button>
              <button class="tool text" id="xal10"></button>
              <button class="tool text" id="xal11"></button>
              <button class="tool text" id="xal12"></button>
              <button class="tool text" id="xal13"></button>
              <button class="tool text" id="xal14"></button>
              <button class="tool text" id="xal15"></button>
              <button class="tool text" id="xal16"></button>
              <button class="tool text" id="xal17"></button>
              <button class="tool text" id="xal18"></button>
              <button class="tool text" id="xal19"></button>
              <button class="tool text" id="xal20"></button>
              <button class="tool text" id="xal21"></button>
              <button class="tool text" id="xal22"></button>
              <button class="tool text" id="xal23"></button>
              <button class="tool text" id="xal24"></button>
              <button class="tool text" id="xal25"></button>
              <button class="tool text" id="xal26"></button>
              <button class="tool text" id="xal27"></button>
              <button class="tool text" id="xal28"></button>
              <button class="tool text" id="xal29"></button>
              <button class="tool text" id="alnext">
                <h1>↪</h1>
              </button>
            </div>
          </div>
          <div id="paint">
            <!-- ultra widescreen:  -->
            <!-- <canvas id="kiddopaint" class="pixelated" width="3000" height="1200">:(</canvas> -->
            <!-- 2017 mbp laptop:  -->
            <canvas id="kiddopaint" class="pixelated" width="1300" height="650"
              >:(</canvas
            >
          </div>
        </div>
      </div>
    </div>

    <!-- Toggle script -->
    <script>
      // Simple version toggle (temporary)
      const useReact = new URLSearchParams(window.location.search).has("react");
      if (useReact) {
        document.getElementById("js-root").style.display = "none";
        document.getElementById("react-root").style.display = "block";
      }
    </script>

    <!-- React version entry -->
    <script type="module" src="/src/main.tsx"></script>

    <!-- Keyboard Shortcuts Help Popup -->
    <div id="keyboard-shortcuts-popup" class="modal-overlay" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Keyboard Shortcuts</h2>
          <button class="close-btn" aria-label="Close">&times;</button>
        </div>
        <div class="modal-body">
          <!-- Content shown when shortcuts are enabled -->
          <div id="shortcuts-enabled-content">
            <section class="shortcuts-section">
              <h3>Single-Key Shortcuts</h3>
              <dl class="shortcuts-list">
                <dt><kbd>n</kbd></dt>
                <dd>Cycle to next color</dd>
                <dt><kbd>c</kbd></dt>
                <dd>Cycle to next color palette</dd>
                <dt><kbd>r</kbd></dt>
                <dd>Randomize colors</dd>
                <dt><kbd>s</kbd></dt>
                <dd>Save drawing to file</dd>
                <dt><kbd>v</kbd></dt>
                <dd>Toggle velocity state</dd>
                <dt><kbd>1-9</kbd></dt>
                <dd>Set multiplier (1-9)</dd>
                <dt><kbd>Space</kbd></dt>
                <dd>Toggle modified state</dd>
                <dt><kbd>?</kbd></dt>
                <dd>Show/hide this help</dd>
              </dl>
            </section>
            <section class="modifiers-section">
              <h3>Modifier Keys</h3>
              <p class="modifier-intro">Hold these keys while using tools for special effects:</p>
              <dl class="shortcuts-list">
                <dt><kbd>Shift</kbd></dt>
                <dd>Enlarge effect, snap to grid, or constrain proportions</dd>
                <dt><kbd>Cmd</kbd> / <kbd>Ctrl</kbd></dt>
                <dd>Special effects and alternative behaviors</dd>
                <dt><kbd>Alt</kbd></dt>
                <dd>Additional variations</dd>
                <dt><kbd>Ctrl</kbd></dt>
                <dd>Advanced features</dd>
              </dl>
              <p class="modifier-note">See full modifier key documentation for details on each tool.</p>
            </section>
          </div>
          <!-- Content shown when shortcuts are disabled -->
          <div id="shortcuts-disabled-content" style="display: none;">
            <p class="disabled-message">
              Keyboard shortcuts are currently disabled. Enable them to use single-key shortcuts like <kbd>n</kbd>, <kbd>c</kbd>, <kbd>r</kbd>, <kbd>s</kbd>, and <kbd>v</kbd>.
            </p>
            <p class="disabled-note">
              Note: Modifier keys (<kbd>Shift</kbd>, <kbd>Cmd</kbd>, <kbd>Ctrl</kbd>, <kbd>Alt</kbd>) work regardless of this setting.
            </p>
            <div class="console-instructions">
              <h4>Enable/Disable Keyboard Shortcuts</h4>
              <p>Open your browser's developer console and run:</p>
              <pre><code>// Enable shortcuts
KiddoPaint.Settings.setKeyboardShortcutsEnabled(true)

// Disable shortcuts
KiddoPaint.Settings.setKeyboardShortcutsEnabled(false)</code></pre>
              <p class="console-note">Then reload the page for changes to take effect.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
