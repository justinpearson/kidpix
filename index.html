<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta property="og:title" content="JSKIDPIX v1.0.2021" />
    <meta property="og:site_name" content="JSKIDPIX v1.0.2021" />
    <meta property="og:url" content="https://kidpix.app/" />
    <meta property="og:description" content="JSKIDPIX v1.0.2021" />
    <meta
      property="og:image"
      content="https://kidpix.app/static/jskidpix.png"
    />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="632" />
    <meta property="og:image:height" content="394" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="@vikrum5000" />
    <meta name="twitter:title" content="JSKIDPIX v1.0.2021" />
    <meta name="twitter:description" content="JSKidPix ‚ú®" />
    <meta
      name="twitter:image"
      content="https://kidpix.app/static/jskidpix.png"
    />
    <meta name="msapplication-tap-highlight" content="no" />
    <title>JSKIDPIX v1.0.2021</title>
    <link rel="stylesheet" type="text/css" href="./src/assets/css/kidpix.css" />
    <link rel="icon" type="image/png" href="./src/assets/img/kidpix.png" />

    <!-- Initialize global KiddoPaint namespace before modules load -->
    <script>
      // Initialize the global KiddoPaint namespace
      window.KiddoPaint = {};
      window.KiddoPaint.Tools = {};
      window.KiddoPaint.Tools.Toolbox = {};
      window.KiddoPaint.Textures = {};
      window.KiddoPaint.Brushes = {};
      window.KiddoPaint.Builders = {};
      window.KiddoPaint.Stamps = {};
      window.KiddoPaint.Sounds = {};
      window.KiddoPaint.Display = {};
      window.KiddoPaint.Colors = {};
      window.KiddoPaint.Current = {};
      window.KiddoPaint.Cache = {};
      window.KiddoPaint.Alphabet = {};
      window.KiddoPaint.Sprite = {};
    </script>

    <!-- Runtime error handler for terminal display -->
    <script type="module">
      import { terminal } from "virtual:terminal";

      // Test terminal logging
      terminal.log(
        "üß™ Terminal plugin test - this should appear in the terminal",
      );

      // Capture uncaught exceptions
      window.addEventListener("error", function (event) {
        const timestamp = new Date().toLocaleString();
        const errorInfo = {
          message: event.message,
          filename: event.filename,
          lineno: event.lineno,
          colno: event.colno,
          error: event.error ? event.error.stack : "No stack trace available",
        };

        const errorMsg = `üö® [${timestamp}] Runtime Error: ${errorInfo.message}\n   at ${errorInfo.filename}:${errorInfo.lineno}:${errorInfo.colno}\n   Stack: ${errorInfo.error}`;
        terminal.error(errorMsg);
      });

      // Capture unhandled promise rejections
      window.addEventListener("unhandledrejection", function (event) {
        const timestamp = new Date().toLocaleString();
        const errorMsg = `üö® [${timestamp}] Unhandled Promise Rejection: ${event.reason}\n   Stack: ${event.reason?.stack || "No stack trace available"}`;
        terminal.error(errorMsg);
      });

      // Override console.error to also log to terminal (avoid infinite loop)
      const originalConsoleError = console.error;
      console.error = function (...args) {
        originalConsoleError.apply(console, arguments);
        // Only log to terminal if not already a terminal error message
        if (!args[0] || !args[0].toString().includes("üö®")) {
          const timestamp = new Date().toLocaleString();
          terminal.error(`üö® [${timestamp}] Console Error:`, ...args);
        }
      };
    </script>

    <!-- Bundled KidPix JavaScript modules -->
    <script type="module" src="/src/kidpix-main.js"></script>
  </head>

  <body>
    <!-- React version -->
    <div id="react-root" style="display: none"></div>

    <!-- Original JavaScript version (default for now) -->
    <div id="js-root">
      <div id="container">
        <div id="toolbar">
          <div id="mainbar">
            <button class="tool" id="save" title="Save">
              <img src="./src/assets/img/kp-m_27.png" class="pixelated" />
            </button>
            <button class="tool" id="pencil" title="Pencil">
              <img
                src="./src/assets/img/kp-m_28.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="line" title="Line">
              <img
                src="./src/assets/img/kp-m_29.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="square" title="Rectangle">
              <img
                src="./src/assets/img/kp-m_30.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="circle" title="Circle">
              <img
                src="./src/assets/img/kp-m_31.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="brush" title="Brush">
              <img
                src="./src/assets/img/kp-m_32.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="jumble" title="Mixer">
              <img
                src="./src/assets/img/kp-m_33.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="flood" title="Paint Can">
              <img
                src="./src/assets/img/kp-m_34.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="eraser" title="Eraser">
              <img
                src="./src/assets/img/kp-m_35.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="alphabet" title="Text">
              <img
                src="./src/assets/img/kp-m_36.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="stamp" title="Stamp">
              <img
                src="./src/assets/img/kp-m_37.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="truck" title="Truck">
              <img
                src="./src/assets/img/kp-m_38.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="undo" title="Undo">
              <img
                src="./src/assets/img/kp-m_39.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
            <button class="tool" id="redo" title="Redo">
              <img
                src="./src/assets/img/kp-m_40.png"
                class="pixelated"
                width="48"
                height="48"
              />
            </button>
          </div>
          <br />
          <div id="colorbar">
            <button class="currentColor" id="currentColor"></button>
            <div id="colorselector">
              <button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button
              ><button class="color"></button><button class="color"></button>
            </div>
            <div>
              <button class="colornav" id="colorprev">‚Üê</button
              ><button class="colornav" id="colornext">‚Üí</button>
            </div>
            <br />
            <div>
              <button class="colornav">
                <a href="https://github.com/justinpearson/kidpix" target="_blank"
                  ><img
                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTIgMGMtNi42MjYgMC0xMiA1LjM3My0xMiAxMiAwIDUuMzAyIDMuNDM4IDkuOCA4LjIwNyAxMS4zODcuNTk5LjExMS43OTMtLjI2MS43OTMtLjU3N3YtMi4yMzRjLTMuMzM4LjcyNi00LjAzMy0xLjQxNi00LjAzMy0xLjQxNi0uNTQ2LTEuMzg3LTEuMzMzLTEuNzU2LTEuMzMzLTEuNzU2LTEuMDg5LS43NDUuMDgzLS43MjkuMDgzLS43MjkgMS4yMDUuMDg0IDEuODM5IDEuMjM3IDEuODM5IDEuMjM3IDEuMDcgMS44MzQgMi44MDcgMS4zMDQgMy40OTIuOTk3LjEwNy0uNzc1LjQxOC0xLjMwNS43NjItMS42MDQtMi42NjUtLjMwNS01LjQ2Ny0xLjMzNC01LjQ2Ny01LjkzMSAwLTEuMzExLjQ2OS0yLjM4MSAxLjIzNi0zLjIyMS0uMTI0LS4zMDMtLjUzNS0xLjUyNC4xMTctMy4xNzYgMCAwIDEuMDA4LS4zMjIgMy4zMDEgMS4yMy45NTctLjI2NiAxLjk4My0uMzk5IDMuMDAzLS40MDQgMS4wMi4wMDUgMi4wNDcuMTM4IDMuMDA2LjQwNCAyLjI5MS0xLjU1MiAzLjI5Ny0xLjIzIDMuMjk3LTEuMjMuNjUzIDEuNjUzLjI0MiAyLjg3NC4xMTggMy4xNzYuNzcuODQgMS4yMzUgMS45MTEgMS4yMzUgMy4yMjEgMCA0LjYwOS0yLjgwNyA1LjYyNC01LjQ3OSA1LjkyMS40My4zNzIuODIzIDEuMTAyLjgyMyAyLjIyMnYzLjI5M2MwIC4zMTkuMTkyLjY5NC44MDEuNTc2IDQuNzY1LTEuNTg5IDguMTk5LTYuMDg2IDguMTk5LTExLjM4NiAwLTYuNjI3LTUuMzczLTEyLTEyLTEyeiIvPjwvc3ZnPg=="
                    class="github"
                /></a></button
              ><button class="colornav">
                <a
                  href="https://justinppearson.com/"
                  target="_blank"
                  ><img
                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIvPjxsaW5lIHgxPSIyIiB5MT0iMTIiIHgyPSIyMiIgeTI9IjEyIi8+PGxpbmUgeDE9IjEyIiB5MT0iMiIgeDI9IjEyIiB5Mj0iMjIiLz48cGF0aCBkPSJNMTIgMmMtMyAwLTUuNSA0LjUtNS41IDEwczIuNSAxMCA1LjUgMTAiLz48cGF0aCBkPSJNMTIgMmMzIDAgNS41IDQuNSA1LjUgMTBzLTIuNSAxMC01LjUgMTAiLz48L3N2Zz4="
                    class="github"
                /></a>
              </button><button class="colornav">
                <a
                  href="/docs/"
                  target="_blank"
                  ><img
                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIj48cGF0aCBkPSJNMTQgMmwtNiAwYy0xIDAtMiAxLTIgMnYxNmMwIDEgMSAyIDIgMmgxMmMxIDAgMi0xIDItMlY4bC02LTZ6Ii8+PHBvbHlsaW5lIHBvaW50cz0iMTQsMiAxNCw4IDIwLDgiLz48bGluZSB4MT0iMTYiIHkxPSIxMyIgeDI9IjgiIHkyPSIxMyIvPjxsaW5lIHgxPSIxNiIgeTE9IjE3IiB4Mj0iOCIgeTI9IjE3Ii8+PC9zdmc+"
                    class="github"
                /></a>
              </button>
            </div>
          </div>
        </div>
        <div id="hcontainer">
          <div id="subtoolbars" class="subtoolbar">
            <div id="genericsubmenu" class="hidden"></div>
            <div id="alphabettoolbar" class="hidden">
              <button class="tool alphabet" id="xal0"></button>
              <button class="tool alphabet" id="xal1"></button>
              <button class="tool alphabet" id="xal2"></button>
              <button class="tool alphabet" id="xal3"></button>
              <button class="tool alphabet" id="xal4"></button>
              <button class="tool alphabet" id="xal5"></button>
              <button class="tool alphabet" id="xal6"></button>
              <button class="tool alphabet" id="xal7"></button>
              <button class="tool alphabet" id="xal8"></button>
              <button class="tool alphabet" id="xal9"></button>
              <button class="tool alphabet" id="xal10"></button>
              <button class="tool alphabet" id="xal11"></button>
              <button class="tool alphabet" id="xal12"></button>
              <button class="tool alphabet" id="xal13"></button>
              <button class="tool alphabet" id="xal14"></button>
              <button class="tool alphabet" id="xal15"></button>
              <button class="tool alphabet" id="xal16"></button>
              <button class="tool alphabet" id="xal17"></button>
              <button class="tool alphabet" id="xal18"></button>
              <button class="tool alphabet" id="xal19"></button>
              <button class="tool alphabet" id="xal20"></button>
              <button class="tool alphabet" id="xal21"></button>
              <button class="tool alphabet" id="xal22"></button>
              <button class="tool alphabet" id="xal23"></button>
              <button class="tool alphabet" id="xal24"></button>
              <button class="tool alphabet" id="xal25"></button>
              <button class="tool alphabet" id="xal26"></button>
              <button class="tool alphabet" id="xal27"></button>
              <button class="tool alphabet" id="xal28"></button>
              <button class="tool alphabet" id="xal29"></button>
              <button class="tool alphabet" id="alnext">
                <h1>‚Ü™</h1>
              </button>
            </div>
          </div>
          <div id="paint">
            <!-- ultra widescreen:  -->
            <!-- <canvas id="kiddopaint" class="pixelated" width="3000" height="1200">:(</canvas> -->
            <!-- 2017 mbp laptop:  -->
            <canvas id="kiddopaint" class="pixelated" width="1300" height="650"
              >:(</canvas
            >
          </div>
        </div>
      </div>
    </div>

    <!-- Toggle script -->
    <script>
      // Simple version toggle (temporary)
      const useReact = new URLSearchParams(window.location.search).has("react");
      if (useReact) {
        document.getElementById("js-root").style.display = "none";
        document.getElementById("react-root").style.display = "block";
      }
    </script>

    <!-- React version entry -->
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
